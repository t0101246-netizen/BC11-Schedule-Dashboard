<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>P6 å°ˆæ¡ˆæ’ç¨‹å„€è¡¨æ¿ (æ³•è¦åˆè¦ç‰ˆ)</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body { margin: 0; padding: 20px; font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; background-color: #f4f4f4; }
        
        /* --- 1. å¯†ç¢¼é®ç½©å±¤æ¨£å¼ --- */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex; justify-content: center; align-items: center;
            z-index: 9999;
        }
        .login-box {
            background: white; padding: 40px; border-radius: 12px;
            box-shadow: 0 0 25px rgba(0,0,0,0.7); text-align: center; width: 320px;
        }
        .login-box h3 { margin-top: 0; color: #333; margin-bottom: 20px;}
        .login-box input {
            width: 100%; padding: 12px; margin: 10px 0;
            box-sizing: border-box; border: 2px solid #ddd; border-radius: 6px;
            font-size: 18px; text-align: center; letter-spacing: 2px;
        }
        .login-box button {
            width: 100%; padding: 12px; background-color: #1f77b4;
            color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; margin-top: 10px;
            transition: background 0.3s;
        }
        .login-box button:hover { background-color: #155a8a; }
        #error-msg { color: #d62728; font-size: 0.9em; margin-top: 15px; display: none; font-weight: bold;}

        /* --- 2. ä¸»å…§å®¹å€åŸŸ --- */
        #main-content { display: none; }
        .container { background-color: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        
        h2 { text-align: center; color: #333; margin-bottom: 10px; }
        
        /* åˆ‡æ›æŒ‰éˆ•å€ */
        .nav-buttons { text-align: center; margin-bottom: 20px; }
        .btn-toggle {
            padding: 10px 20px; margin: 0 5px; cursor: pointer;
            border: 2px solid #1f77b4; background: white; color: #1f77b4;
            border-radius: 5px; font-weight: bold; font-size: 16px;
            transition: all 0.3s;
        }
        .btn-toggle:hover { background: #eef; }
        .btn-toggle.active {
            background: #1f77b4; color: white;
        }

        .info { text-align: center; color: #666; margin-bottom: 15px; font-size: 0.95em; background: #eef; padding: 15px; border-radius: 4px; border-left: 5px solid #1f77b4;}
        
        #gantt-chart { width: 100%; min-height: 800px; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h3>ğŸ”’ å°ˆæ¡ˆæ’ç¨‹ç³»çµ±</h3>
        <input type="password" id="password-input" placeholder="è«‹è¼¸å…¥å¯†ç¢¼" onkeyup="if(event.keyCode===13) checkPassword()">
        <button onclick="checkPassword()">è§£é–æª¢è¦–</button>
        <div id="error-msg">âš ï¸ å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹é‡è©¦</div>
    </div>
</div>

<div id="main-content">
    <div class="container">
        <h2>P6 å°ˆæ¡ˆæ’ç¨‹å‹•æ…‹å„€è¡¨æ¿ (æ³•è¦åˆè¦ç‰ˆ)</h2>
        
        <div class="nav-buttons">
            <button class="btn-toggle active" id="btn-full" onclick="switchView('full')">ğŸ“Š é¡¯ç¤ºå®Œæ•´æ’ç¨‹ (Full WBS)</button>
            <button class="btn-toggle" id="btn-cp" onclick="switchView('cp')">ğŸš© é¡¯ç¤ºé—œéµè·¯å¾‘ (CP Only)</button>
        </div>

        <div class="info" id="info-box">
            è¼‰å…¥ä¸­...
        </div>

        <div id="gantt-chart"></div>
    </div>
</div>

<script>
    // --- è³‡æ–™é›†å®šç¾© (æ ¹æ“šæœ€æ–°åœ–ç‰‡æ•¸æ“šè¼¸å…¥) ---

    // 1. å®Œæ•´è³‡æ–™ (Full WBS)
    var fullTasks = [
        // 1. å°ˆæ¡ˆå•Ÿå‹•èˆ‡è¡Œæ”¿ (æ³•è¦åˆè¦)
        {id: "1000", name: "1000 å°ˆæ¡ˆå•Ÿå‹• (NTP) - æ±ºæ¨™ç°½ç´„", start: "2026-04-20", finish: "2026-04-20", group: "1.è¡Œæ”¿æ³•è¦", color: "#d62728"},
        {id: "1005", name: "1005 è¾¦ç†: å·¥ç¨‹ä¿éšªå–®æŠ•ä¿", start: "2026-04-21", finish: "2026-04-28", group: "1.è¡Œæ”¿æ³•è¦", color: "#1f77b4"},
        {id: "1010", name: "1010 æé€: æ•´é«”/å“è³ª/å®‰è¡›/BIMè¨ˆç•«", start: "2026-04-21", finish: "2026-05-06", group: "1.è¡Œæ”¿æ³•è¦", color: "#1f77b4"},
        {id: "1020", name: "1020 å¯©æŸ¥/æ ¸å®š: ä¸é¡å±éšªæ€§å·¥ä½œå ´æ‰€è©•ä¼° (å±è©•)", start: "2026-04-21", finish: "2026-06-11", group: "1.è¡Œæ”¿æ³•è¦", color: "#1f77b4"},
        {id: "1030", name: "1030 èª¿æŸ¥: é„°æˆ¿ç¾æ³é‘‘å®š", start: "2026-04-21", finish: "2026-06-11", group: "1.è¡Œæ”¿æ³•è¦", color: "#17becf"},
        {id: "1040", name: "1040 æé€/æ ¸å®š: ç’°ä¿è¨±å¯ (é€•æµå»¢æ°´/ç©ºæ±¡/å»¢æ£„ç‰©)", start: "2026-04-21", finish: "2026-05-25", group: "1.è¡Œæ”¿æ³•è¦", color: "#1f77b4"},
        {id: "1050", name: "1050 å¯©æŸ¥/æ ¸å®š: äº¤é€šç¶­æŒè¨ˆç•« (é“å®‰æœƒå ±)", start: "2026-05-07", finish: "2026-06-22", group: "1.è¡Œæ”¿æ³•è¦", color: "#9467bd"},
        {id: "1060", name: "1060 ç”³è«‹/å–å¾—: é“è·¯æŒ–æ˜è¨±å¯è­‰ (è·¯è­‰)", start: "2026-05-30", finish: "2026-06-15", group: "1.è¡Œæ”¿æ³•è¦", color: "#d62728"},
        
        // 2. è¨ˆç•«èˆ‡è©¦é©— (å«ææ–™æºé ­)
        {id: "2005", name: "2005 é€å¯©: é‹¼ç­‹/æ··å‡åœŸææ–™èˆ‡ä¾›æ‡‰å•†", start: "2026-05-07", finish: "2026-05-29", group: "2.è¨ˆç•«è©¦é©—", color: "#17becf"},
        {id: "2010", name: "2010 è©¦æ‹Œ: é æ‹Œæ··å‡åœŸé…æ¯”è¨­è¨ˆ (Trial Mix)", start: "2026-05-30", finish: "2026-07-15", group: "2.è¨ˆç•«è©¦é©—", color: "#17becf"},
        {id: "2020", name: "2020 æ ¸å®š: æ··å‡åœŸé…æ¯”è¨­è¨ˆå ±å‘Š", start: "2026-07-16", finish: "2026-08-07", group: "2.è¨ˆç•«è©¦é©—", color: "#17becf"},
        {id: "2030", name: "2030 æ–½ä½œ: å·¨ç©æ··å‡åœŸæ¨¡å‹è©¦é©—", start: "2026-08-08", finish: "2026-09-29", group: "2.è¨ˆç•«è©¦é©—", color: "#17becf"},

        // 3. å ´åœ°æº–å‚™ (å¯¦è³ªé–‹å·¥)
        {id: "3035", name: "3035 é‡Œç¨‹ç¢‘: å¯¦è³ªé–‹å·¥ (Commencement)", start: "2026-06-20", finish: "2026-06-20", group: "é‡Œç¨‹ç¢‘", color: "#d62728"},
        {id: "3030", name: "3030 æ¶è¨­: æ–½å·¥åœç±¬ (Phase 1)", start: "2026-06-22", finish: "2026-07-14", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        {id: "3010", name: "3010 æ–½ä½œ: æ—¢æœ‰æ¤æ ½ç§»æ¤èˆ‡ä¿è­·", start: "2026-06-22", finish: "2026-07-14", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        {id: "3040", name: "3040 é‹ªè¨­: æ–½å·¥æ§‹å°èˆ‡ä¾¿é“", start: "2026-06-27", finish: "2026-07-14", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        {id: "3050", name: "3050 å®‰è£: ç›£æ¸¬å„€å™¨èˆ‡åˆå§‹è®€æ•¸", start: "2026-06-27", finish: "2026-07-08", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        {id: "3060", name: "3060 æ–½ä½œ: æ–½å·¥æ¸¬é‡èˆ‡æ”¾æ¨£", start: "2026-06-22", finish: "2026-06-29", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        {id: "3070", name: "3070 è¨­ç½®: å·¥å‹™æ‰€èˆ‡è‡¨æ™‚æ°´é›»ç”³è«‹", start: "2026-06-22", finish: "2026-07-25", group: "3.å ´åœ°æº–å‚™", color: "#2ca02c"},
        
        // 4. æ·ºå±¤ç®¡ç·šèˆ‡è©¦é©—
        {id: "4010", name: "4010 è©¦æŒ–: åŸºæ¨é»ä½è©¦æŒ–", start: "2026-07-03", finish: "2026-07-14", group: "4.ç®¡ç·šè™•ç†", color: "#8c564b"},
        {id: "4020", name: "4020 é·ç§»: è·¯ç‡ˆ/è™ŸèªŒè‡¨æ™‚ä¾›é›»æ¶è¨­", start: "2026-07-08", finish: "2026-07-30", group: "4.ç®¡ç·šè™•ç†", color: "#8c564b"},
        
        // 5. åŸºç¤å·¥ç¨‹ (é«˜åº¦å¹³è¡ŒåŒ–)
        {id: "5005", name: "5005 æ–½ä½œ: åœ°è³ªæ”¹è‰¯ (JSG) - å…¨å€", start: "2026-07-31", finish: "2026-09-26", group: "5.åŸºç¤å·¥ç¨‹", color: "#2ca02c"},
        {id: "5010", name: "5010 æ–½ä½œ: è©¦æ¨ (Test Pile) é‘½æ˜èˆ‡æ¾†ç½®", start: "2026-08-12", finish: "2026-09-03", group: "5.åŸºç¤å·¥ç¨‹", color: "#2ca02c"},
        {id: "5015", name: "5015 ç­‰å¾…/æª¢æ¸¬: è©¦æ¨é¤Šæ²»èˆ‡è¼‰é‡è©¦é©—", start: "2026-09-04", finish: "2026-09-23", group: "5.åŸºç¤å·¥ç¨‹", color: "#2ca02c"},
        {id: "5020", name: "5020 æ–½ä½œ: å…¨å¥—ç®¡åŸºæ¨ (Zone A)", start: "2026-09-28", finish: "2026-11-12", group: "5.åŸºç¤å·¥ç¨‹", color: "#2ca02c"},
        {id: "5030", name: "5030 æª¢æ¸¬/æ¨åº•çŒæ¼¿", start: "2026-11-07", finish: "2026-11-23", group: "5.åŸºç¤å·¥ç¨‹", color: "#2ca02c"},
        {id: "5040", name: "5040 ç±Œè¨­: é é‘„æ¢å ´èˆ‡é‹¼æ¨¡è£½ä½œ", start: "2026-09-28", finish: "2027-02-13", group: "5.åŸºç¤å·¥ç¨‹", color: "#7f7f7f"},
        
        // 6. æ¨å¸½å·¥ç¨‹
        {id: "6010", name: "6010 æ–½ä½œ: æ¨å¸½é–‹æŒ–èˆ‡æ“‹åœŸ", start: "2026-11-19", finish: "2026-12-05", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6030", name: "6030 æ–½ä½œ: PC æ¾†ç½®/æ¨é ­è™•ç†/æ¥åœ°", start: "2026-12-01", finish: "2026-12-11", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6040", name: "6040 ç¶ç´®: æ¨å¸½é‹¼ç­‹ (å«éŒ¨æ “é åŸ‹)", start: "2026-12-07", finish: "2026-12-22", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6050", name: "6050 ç•Œé¢: æ¥åœ°ç¶²ç†”æ¥èˆ‡æ¸¬è©¦", start: "2026-12-12", finish: "2026-12-17", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6060", name: "6060 çµ„ç«‹: æ¨å¸½æ¨¡æ¿", start: "2026-12-18", finish: "2026-12-23", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6065", name: "6065 æŸ¥é©—: é‹¼ç­‹èˆ‡æ¨¡æ¿æŸ¥é©— (Inspection)", start: "2026-12-24", finish: "2026-12-24", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        {id: "6070", name: "6070 æ¾†ç½®: æ¨å¸½å·¨ç©æ··å‡åœŸ", start: "2026-12-25", finish: "2026-12-25", group: "6.æ¨å¸½å·¥ç¨‹", color: "#ff7f0e"},
        
        // 7. å¢©æŸ±å·¥ç¨‹
        {id: "7010", name: "7010 æ­è¨­: é‡å‹æ–½å·¥æ¶", start: "2027-01-02", finish: "2027-01-07", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "7020", name: "7020 ç¶ç´®: å¢©æŸ±ç¬¬ä¸€å‡å±¤é‹¼ç­‹", start: "2027-01-08", finish: "2027-01-19", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "7030", name: "7030 ç•Œé¢: é åŸ‹æ’æ°´ç®¡èˆ‡æ©Ÿé›»ç®¡è·¯", start: "2027-01-08", finish: "2027-01-11", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "7040", name: "7040 çµ„ç«‹: å¢©æŸ±ç¬¬ä¸€å‡å±¤é‹¼æ¨¡", start: "2027-01-16", finish: "2027-01-21", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "7050", name: "7050 æŸ¥é©—: å¢©æŸ±é‹¼ç­‹æ¨¡æ¿æŸ¥é©—", start: "2027-01-22", finish: "2027-01-22", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "7060", name: "7060 æ¾†ç½®: å¢©æŸ±ç¬¬ä¸€å‡å±¤æ··å‡åœŸ", start: "2027-01-23", finish: "2027-01-23", group: "7.å¢©æŸ±å·¥ç¨‹", color: "#ff7f0e"},
        {id: "8000", name: "8000 é‡Œç¨‹ç¢‘: é”æˆå¢©æŸ±ç¬¬ä¸€å‡å±¤", start: "2027-01-23", finish: "2027-01-23", group: "é‡Œç¨‹ç¢‘", color: "#d62728"}
    ];

    // 2. é—œéµè·¯å¾‘è³‡æ–™ (CP Only - æ ¹æ“š Logic æ¬„ä½è¿½è¹¤)
    // è·¯å¾‘: 1000 -> 1010 -> 1050 -> 1060 -> 3035 -> 3030/3040 -> 4010/4020 -> 5005 -> 5010 -> 5015 -> 5020 -> 5030 -> 6010...
    var cpTasks = [
        {id: "1000", name: "1000 å°ˆæ¡ˆå•Ÿå‹• (NTP) - æ±ºæ¨™ç°½ç´„", start: "2026-04-20", finish: "2026-04-20", group: "1.å°ˆæ¡ˆå•Ÿå‹•", color: "#d62728"},
        {id: "1010", name: "1010 æé€: æ•´é«”/å“è³ª/å®‰è¡›/BIMè¨ˆç•«", start: "2026-04-21", finish: "2026-05-06", group: "1.è¡Œæ”¿æ³•è¦ (CP)", color: "#1f77b4"},
        {id: "1050", name: "1050 å¯©æŸ¥/æ ¸å®š: äº¤é€šç¶­æŒè¨ˆç•«", start: "2026-05-07", finish: "2026-06-22", group: "1.è¡Œæ”¿æ³•è¦ (CP)", color: "#9467bd"},
        {id: "1060", name: "1060 ç”³è«‹/å–å¾—: é“è·¯æŒ–æ˜è¨±å¯è­‰", start: "2026-05-30", finish: "2026-06-15", group: "1.è¡Œæ”¿æ³•è¦ (CP)", color: "#d62728"},
        {id: "3035", name: "3035 é‡Œç¨‹ç¢‘: å¯¦è³ªé–‹å·¥", start: "2026-06-20", finish: "2026-06-20", group: "é‡Œç¨‹ç¢‘", color: "#d62728"},
        {id: "3030", name: "3030 æ¶è¨­: æ–½å·¥åœç±¬ (Phase 1)", start: "2026-06-22", finish: "2026-07-14", group: "3.å ´åœ°æº–å‚™ (CP)", color: "#2ca02c"},
        {id: "3040", name: "3040 é‹ªè¨­: æ–½å·¥æ§‹å°èˆ‡ä¾¿é“", start: "2026-06-27", finish: "2026-07-14", group: "3.å ´åœ°æº–å‚™ (CP)", color: "#2ca02c"},
        {id: "4010", name: "4010 è©¦æŒ–: åŸºæ¨é»ä½è©¦æŒ–", start: "2026-07-03", finish: "2026-07-14", group: "4.ç®¡ç·šè™•ç† (CP)", color: "#8c564b"},
        {id: "4020", name: "4020 é·ç§»: è·¯ç‡ˆ/è™ŸèªŒè‡¨æ™‚ä¾›é›»æ¶è¨­", start: "2026-07-08", finish: "2026-07-30", group: "4.ç®¡ç·šè™•ç† (CP)", color: "#8c564b"},
        {id: "5005", name: "5005 æ–½ä½œ: åœ°è³ªæ”¹è‰¯ (JSG) - å…¨å€", start: "2026-07-31", finish: "2026-09-26", group: "5.åŸºç¤å·¥ç¨‹ (CP)", color: "#2ca02c"},
        {id: "5010", name: "5010 æ–½ä½œ: è©¦æ¨ (Test Pile) é‘½æ˜èˆ‡æ¾†ç½®", start: "2026-08-12", finish: "2026-09-03", group: "5.åŸºç¤å·¥ç¨‹ (CP)", color: "#2ca02c"},
        {id: "5015", name: "5015 ç­‰å¾…/æª¢æ¸¬: è©¦æ¨é¤Šæ²»èˆ‡è¼‰é‡è©¦é©—", start: "2026-09-04", finish: "2026-09-23", group: "5.åŸºç¤å·¥ç¨‹ (CP)", color: "#2ca02c"},
        {id: "5020", name: "5020 æ–½ä½œ: å…¨å¥—ç®¡åŸºæ¨ (Zone A)", start: "2026-09-28", finish: "2026-11-12", group: "5.åŸºç¤å·¥ç¨‹ (CP)", color: "#2ca02c"},
        {id: "5030", name: "5030 æª¢æ¸¬/æ¨åº•çŒæ¼¿", start: "2026-11-07", finish: "2026-11-23", group: "5.åŸºç¤å·¥ç¨‹ (CP)", color: "#2ca02c"},
        {id: "6010", name: "6010 æ–½ä½œ: æ¨å¸½é–‹æŒ–èˆ‡æ“‹åœŸ", start: "2026-11-19", finish: "2026-12-05", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "6030", name: "6030 æ–½ä½œ: PC æ¾†ç½®/æ¨é ­è™•ç†/æ¥åœ°", start: "2026-12-01", finish: "2026-12-11", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "6040", name: "6040 ç¶ç´®: æ¨å¸½é‹¼ç­‹ (å«éŒ¨æ “é åŸ‹)", start: "2026-12-07", finish: "2026-12-22", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "6050", name: "6050 ç•Œé¢: æ¥åœ°ç¶²ç†”æ¥èˆ‡æ¸¬è©¦", start: "2026-12-12", finish: "2026-12-17", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "6060", name: "6060 çµ„ç«‹: æ¨å¸½æ¨¡æ¿", start: "2026-12-18", finish: "2026-12-23", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "6070", name: "6070 æ¾†ç½®: æ¨å¸½å·¨ç©æ··å‡åœŸ", start: "2026-12-25", finish: "2026-12-25", group: "6.æ¨å¸½å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "7010", name: "7010 æ­è¨­: é‡å‹æ–½å·¥æ¶", start: "2027-01-02", finish: "2027-01-07", group: "7.å¢©æŸ±å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "7020", name: "7020 ç¶ç´®: å¢©æŸ±ç¬¬ä¸€å‡å±¤é‹¼ç­‹", start: "2027-01-08", finish: "2027-01-19", group: "7.å¢©æŸ±å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "7040", name: "7040 çµ„ç«‹: å¢©æŸ±ç¬¬ä¸€å‡å±¤é‹¼æ¨¡", start: "2027-01-16", finish: "2027-01-21", group: "7.å¢©æŸ±å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "7060", name: "7060 æ¾†ç½®: å¢©æŸ±ç¬¬ä¸€å‡å±¤æ··å‡åœŸ", start: "2027-01-23", finish: "2027-01-23", group: "7.å¢©æŸ±å·¥ç¨‹ (CP)", color: "#ff7f0e"},
        {id: "8000", name: "8000 é‡Œç¨‹ç¢‘: é”æˆå¢©æŸ±ç¬¬ä¸€å‡å±¤", start: "2027-01-23", finish: "2027-01-23", group: "é‡Œç¨‹ç¢‘", color: "#d62728"}
    ];

    // --- åŠŸèƒ½é‚è¼¯ (èˆ‡åŸç‰ˆç›¸åŒ) ---

    // 1. å¯†ç¢¼é©—è­‰
    function checkPassword() {
        var input = document.getElementById('password-input').value;
        var errorMsg = document.getElementById('error-msg');
        
        if (input === '2623') {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
            switchView('full');
        } else {
            errorMsg.style.display = 'block';
            document.getElementById('password-input').value = '';
            document.getElementById('password-input').focus();
        }
    }

    // 2. åˆ‡æ›è¦–åœ–æ§åˆ¶
    function switchView(mode) {
        var btnFull = document.getElementById('btn-full');
        var btnCp = document.getElementById('btn-cp');
        var infoBox = document.getElementById('info-box');

        if (mode === 'full') {
            btnFull.classList.add('active');
            btnCp.classList.remove('active');
            infoBox.innerHTML = "<strong>ğŸ“Š å®Œæ•´ç‰ˆæª¢è¦– (Full WBS)</strong><br>åŒ…å«ï¼šè¡Œæ”¿æ³•è¦ã€ææ–™è©¦é©—ã€å ´åœ°æº–å‚™ã€ç®¡ç·šã€åŸºç¤ã€æ¨å¸½ã€å¢©æŸ±å®Œæ•´å·¥åº";
            infoBox.style.borderLeftColor = "#1f77b4";
            renderChart(fullTasks, 'full');
        } else {
            btnCp.classList.add('active');
            btnFull.classList.remove('active');
            infoBox.innerHTML = "<strong>ğŸš© é—œéµè·¯å¾‘æª¢è¦– (Critical Path)</strong><br>é¡¯ç¤ºä¸»è¦è·¯å¾‘ï¼šäº¤ç¶­/è·¯è­‰ â” åœç±¬/æ§‹å° â” è‡¨æ™‚ä¾›é›» â” åœ°è³ªæ”¹è‰¯ â” è©¦æ¨ â” å…¨å¥—ç®¡ â” çµæ§‹é«”";
            infoBox.style.borderLeftColor = "#d62728";
            renderChart(cpTasks, 'cp');
        }
    }

    // 3. ç¹ªåœ–æ ¸å¿ƒå‡½æ•¸
    function renderChart(dataSet, mode) {
        var tasks = JSON.parse(JSON.stringify(dataSet));
        tasks.reverse();

        var xData = tasks.map(t => new Date(t.finish) - new Date(t.start) + 86400000);
        var baseData = tasks.map(t => t.start);
        var yData = tasks.map(t => t.name);
        var colorData = tasks.map(t => t.color);
        var hoverData = tasks.map(t => 
            `<b>${t.name}</b><br>é–‹å§‹: ${t.start}<br>å®Œæˆ: ${t.finish}<br>åˆ†é¡: ${t.group}`
        );

        var trace = {
            type: 'bar',
            orientation: 'h',
            x: xData,
            base: baseData,
            y: yData,
            marker: {
                color: colorData,
                opacity: 0.8,
                line: { width: 1, color: '#333' }
            },
            hoverinfo: 'text',
            hovertext: hoverData
        };

        if (mode === 'cp') {
            trace.text = yData;
            trace.textposition = 'auto';
            trace.insidetextanchor = 'start';
            trace.textfont = { family: 'Microsoft JhengHei', color: 'black', size: 12 };
        } else {
            trace.text = tasks.map(t => t.group);
            trace.textposition = 'auto';
        }

        var layout = {
            height: (mode === 'full') ? 1400 : 900,
            xaxis: {
                title: 'æ—¥æœŸ',
                type: 'date',
                tickformat: '%Y-%m',
                automargin: true,
                side: 'top',
                rangeslider: {visible: true},
                gridcolor: '#eee'
            },
            yaxis: {
                automargin: true,
                tickfont: {size: 11},
                showgrid: true
            },
            margin: {l: 300, r: 50, t: 50, b: 50},
            hovermode: 'closest',
            dragmode: 'pan'
        };

        Plotly.newPlot('gantt-chart', [trace], layout);
    }
</script>

</body>
</html>